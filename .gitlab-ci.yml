image: comp1531/basic:latest

stages:
  - automarking

before_script:
  - git config user.email "comp1531-marker@cse.unsw.edu.au"
  - git config user.name "comp1531-marker"
  - git merge remotes/origin/master --allow-unrelated-histories -X ours --no-commit

automarking:
  stage: automarking
  variables:
    GIT_STRATEGY: clone
    GIT_DEPTH: 0
  script:
    - bash automarking.sh $CI_PROJECT_NAME
  only:
    - marking
  artifacts:
    paths:
      - mark.txt
